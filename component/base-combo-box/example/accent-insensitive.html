<script>
  export default {
    data() {
      return {
        label: "Base comboBox",
        description: "ComboBox field without behavior",
        invalid: false,
        errorMessage: null,
        disabled: false,
        required: false,
        borderless: false,
        underlined: false,
        open: false,
        value: null,
        selectedText: "",
        placeholder: "Pick an element",
        readonly: false,
        multiple: true,
        allowFreeform: false,
        autoComplete: false,
        accentInsensitive: false,
        suggestedIndex: -1,
        optionsLoaded: true,
        loadingText: "Loading...",
        immediateScroll: false,
        options: [
          { text: "menjàrem", value: "menjarem" },
          { text: "bàscula", value: "bascula" },
          { text: "vàlid", value: "valid" },
          { text: "matalàs", value: "matalas" },
          { text: "pàmfil", value: "pamfil" },
          { text: "interès", value: "interes" },
          { text: "bèstia", value: "bestia" },
          { text: "mèrit", value: "merit" },
          { text: "canapè", value: "canape" },
          { text: "perquè", value: "perque" },
          { text: "cèntim", value: "centim" },
          { text: "mòdul", value: "modul" },
          { text: "allò", value: "allo" },
          { text: "òliba", value: "oliba" },
          { text: "repòs", value: "repos" },
          { text: "Sònia", value: "Sonia" },
          { text: "arròsvindré", value: "arrosvindre" },
          { text: "créixens", value: "creixens" },
          { text: "haguéreu", value: "haguereu" },
          { text: "accés", value: "acces" },
          { text: "també", value: "tambe" },
          { text: "Berlín", value: "Berlin" },
          { text: "pastís", value: "pastis" },
          { text: "legítima", value: "legitima" },
          { text: "veí", value: "vei" },
          { text: "rítmic", value: "ritmic" },
          { text: "tísic", value: "tisic" },
          { text: "pastós", value: "pastos" },
          { text: "furóncol", value: "furoncol" },
          { text: "tórtora", value: "tortora" },
          { text: "cantó", value: "canto" },
          { text: "institució", value: "institucio" },
          { text: "cautxú", value: "cautxu" },
          { text: "múscul", value: "muscul" },
          { text: "fúcsia", value: "fucsia" },
          { text: "brúixola", value: "bruixola" },
          { text: "pallús", value: "pallus" },
        ],
      };
    },
    methods: {
      onSelect(index) {
        if (this.multiple) {
          const value = this.options[index].value;
          const valueIndex = this.value && this.value.indexOf(value);
          if (valueIndex > -1) {
            this.value.splice(valueIndex, 1);
          } else {
            this.value.push(value);
          }
          this.selectedText = this.value
            .map(
              (value) =>
                this.options.find((option) => option.value === value).text
            )
            .join(", ");
        } else {
          this.value = this.options[index].value;
          this.selectedText = this.options[index].text;
          this.open = false;
        }
      },
      onClick() {
        this.open = !this.open;
      },
    },
  };
</script>
<template>
  <fura-base-combo-box
    :label="label"
    :description="description"
    :invalid="invalid"
    :error-message="errorMessage"
    :disabled="disabled"
    :required="required"
    :borderless="borderless"
    :underlined="underlined"
    :open="open"
    :value="value"
    :selected-text="selectedText"
    :placeholder="placeholder"
    :readonly="readonly"
    :multiple="multiple"
    :allow-freeform="allowFreeform"
    :auto-complete="autoComplete"
    :accent-insensitive="accentInsensitive"
    :suggested-index="suggestedIndex"
    :options-loaded="optionsLoaded"
    :loading-text="loadingText"
    :immediate-scroll="immediateScroll"
    :options="options"
    @select="onSelect"
    @click="onClick"
  />
</template>
